<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Members Price Tag Generator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Barlow+Condensed:wght@600;700;800&family=Montserrat:wght@500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      @font-face {
        font-family: 'FontNumbers';
        src: url('data:font/woff2;base64,d09GMgABAAAAAAWgAA0AAAAACtgAAAVQAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABlYATBEICo4QimEBNgIkA0ALIgAEIAWBdAcgFyQYKBskCAAeh7Hb5IDG+lWoiJE90aY/b3c54C4qhF6UqBCvC1alVEyhdUgdb52kX0SEBgiwQpz//mxHl6k3+9+p0D+2RvCIreyXXq3TW7OahhGJ9eYNgwlQAGMaAMmj5pwTDrZW314Aoul0HBromJfdC6APPps+REMMYNBwHOocL5+8aMQCDEatGFfjZjO4iicBECoHk6ll4CCYLWB+jAwdGBhqtVuDWByAk+t/En/Nq84JhFaB4sDATIFVnSwwV5z1o1YTiBDYDERhUQ4Gf02h0yXlVCXwYVNUbaWqTlLz1EF2BfI7PjC3l/ibR4h7+sCcdiHP6C/pL7HfURV6wP7GG0Qe2QvYyKP4XgPcr1oUJNgtcL+m+BgqN7fSHbfUttc5kaLt4rIMuMtLTsWhWOQrQd+S7BbF6bLaLNeY7mi5Kvc6i8Wf4c+4svnRkd6y22ujxnODyA6rGwEEMgO+7FC2h0JEniwPBbOC3gx/hjvDDchOX+nAfbmB3AgsHg8PJQv5NbN2DN/QFurdtxXUhQDglr7Ej/C9Jf3essv35wXzot1g/uns01UhU+itmQxHpn3NoNOPaMCZaJ0lz7R8sI1E3Dnhe0sGrkP0OjWDdgjcYGo3HzC95pAroJSUDcF5XuVxveHoAna3Z4cSXdvs92bdbgzmBXdjvjRw6fQDpitSdDC4c8IZ4XtL3o5pUtCFzMwRuaE+7sscSFk6XOL3MmrmvVjld7JzwXwkkOIjkkkhzxtYHLC8Mt0KZLhz+LE9104c+KvNONc4fvT+d4ZHysLDw2W41bqI7CdxX4J52Sm+Kf/D+TFIIxafm3yVOb2gIL9g+K684r2xf0/93+h6h12ctO3sgvHwPrPDUDRmwtAJ1nFDx9hNH1Zrah+uyR4+unfyuWPVO4YYcvMMrvysUpcpK3+ZwZBvQN/UK/jmCuEqxSbv5ksOXPto291mNE7DMfckYyfHfJGb9GF8JB9PK5K6OqbXJtUMNqb9tvnS4AUazc5chqkS56xsXYo2ZV0ZE0zqk5go+0txLuk9uGTvao1YI+OllKJDBhLUonCJdd4yRD/klk6mEUoLZ4y7pJW/FWtu+LtTJJrqTAl6LRERo4gtXL4tJ7zo8BwDNb3URPnOw43vf/f7CKvccMs4JglliiIkNu6WhupzAdtoDA2lR0Jf3EBw2g9mbxl+0DXdtZ8vcfy8cU9gz+amzTn7yhc3HVwXWLfxZ4cjfePaGWs2D98ybYa+wbXDuTJE4RrWeUu9fnCs5gt5iCwiMfErk0oHF0J2cBr0Q1hccTxV8I4Y3saW8vDCw+OzUPgCEtQqu3XUrfVy/a2daZKQW2NGc8m/3VRrStRLxEAchxeFcyquwhpfDCvOQ6V163h5SGxDsrd/sDqdX9pG58ajoO975Yzj/9je+r1XRTuqd1R3RK/CHzzl9mZyzVw5UauuKyfBtQd0XFD5OrUM7eHoDmg/aA9Wz1+wfEFiXp7d5DIdGTd5jD2yc+iu3FmG/ALDwGLX4mGGtcAF0/wy/H7kPq8zues3XRX/EgA+2fn6g3DbG7b4cTNllKsAdGCQxPxHwE1rOej/Hd4GhEswJSPEhB7cAEFrQSc0gRaSgIGRSjqNPnzCH9WANBEQZ4BhKncNthORMJFjlIQehDTAxQxJSBNzOKCKBYy2iDVIEcQS7bXDsBqrsQaqkViNVdiAidiIlZiHhViH9YMOjqzD4jqmavwha6k6qDrGD0a+SoN6NRA0agaon6dZ1mGD8VKOfag4Lr9EKaBflzGDfxk3A1cBECqe4GZkuMq/nJXN7DiewpP4uVFfZ+kUngQA') format('woff2'),
          url('data:font/ttf;base64,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') format('truetype');
        font-weight: 400;
        font-style: normal;
        font-display: swap;
      }

      :root {
        --page-width: 21cm;
        --page-height: 29.7cm;
        --page-padding-top: 1.9cm;
        --page-padding-right: 0cm;
        --page-padding-bottom: 1.9cm;
        --page-padding-left: 0cm;
        --column-gap: 0cm;
        --row-gap: 0cm;
        --tag-width: 10.5cm;
        --tag-height: 3.7cm;
        --tag-bg: #050505;
        --tag-text: #ffffff;
        --pill-bg: #ffffff;
        --pill-text: #111827;
        --body-font: 'Montserrat', 'Helvetica Neue', Arial, sans-serif;
        --display-font: 'FontNumbers', 'Barlow Condensed', 'Impact', sans-serif;
        --heading-font: 'Impact', 'Impact Regular', 'Arial Black', sans-serif;
        --heading-height-scale: 1.15;
        --price-height-scale: 1;
        --unit-height-scale: 1;
        --expiry-height-scale: 1;
      }

      *,
      *::before,
      *::after {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: var(--body-font);
        background: #f3f4f6;
        color: #111827;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      header {
        background: #0f172a;
        color: #ffffff;
        padding: 1.5rem 2.5rem;
        font-weight: 700;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        font-size: 1.1rem;
        box-shadow: 0 18px 40px rgba(15, 23, 42, 0.24);
      }

      main {
        flex: 1;
        display: grid;
        grid-template-columns: minmax(320px, 380px) 1fr;
        gap: 2rem;
        padding: 2rem 2.5rem 3rem;
        align-items: flex-start;
      }

      @media (max-width: 1100px) {
        main {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 720px) {
        main {
          padding: 1.5rem;
        }

        header {
          padding: 1.25rem 1.5rem;
        }
      }

      .controls {
        background: #ffffff;
        border-radius: 18px;
        box-shadow: 0 25px 50px -12px rgba(15, 23, 42, 0.22);
        padding: 1.75rem;
        display: flex;
        flex-direction: column;
        gap: 1.5rem;
        max-height: calc(100vh - 6rem);
        overflow: auto;
      }

      @media (max-width: 1100px) {
        .controls {
          max-height: none;
        }
      }

      .controls h2 {
        margin: 0;
        font-size: 1.05rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
      }

      .control-note {
        margin: 0;
        font-size: 0.85rem;
        line-height: 1.5;
        color: #4b5563;
      }

      .controls h3 {
        margin: 0;
        font-size: 0.9rem;
        letter-spacing: 0.06em;
        text-transform: uppercase;
      }

      .control-section {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
      }

      .control-description {
        margin: 0;
        font-size: 0.8rem;
        line-height: 1.4;
        color: #6b7280;
      }

      .scale-controls {
        display: grid;
        gap: 0.85rem;
      }

      .scale-row {
        display: grid;
        gap: 0.4rem;
      }

      .scale-row label {
        font-size: 0.78rem;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        color: #4b5563;
      }

      .scale-input {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .scale-input input[type='range'] {
        flex: 1;
      }

      .scale-output {
        font-size: 0.78rem;
        font-variant-numeric: tabular-nums;
        min-width: 3.5ch;
        text-align: right;
        color: #111827;
      }

      .entries-table-wrapper {
        border: 1px solid #e5e7eb;
        border-radius: 14px;
        overflow: hidden;
      }

      .entries-table {
        width: 100%;
        border-collapse: separate;
        border-spacing: 0;
      }

      .entries-table th,
      .entries-table td {
        border-right: 1px solid #e5e7eb;
        border-bottom: 1px solid #e5e7eb;
        padding: 0.5rem 0.6rem;
        background: #ffffff;
        vertical-align: top;
      }

      .entries-table th:last-child,
      .entries-table td:last-child {
        border-right: none;
      }

      .entries-table tbody tr:last-child td {
        border-bottom: none;
      }

      .entries-table th {
        background: #f3f4f6;
        font-size: 0.75rem;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: #4b5563;
        position: sticky;
        top: 0;
        z-index: 1;
      }

      .entries-table td:first-child,
      .entries-table th:first-child {
        text-align: center;
        width: 2.2rem;
        font-weight: 700;
      }

      .entries-table input[type='text'] {
        width: 100%;
        border-radius: 10px;
        border: 1px solid #d1d5db;
        background: #ffffff;
        padding: 0.45rem 0.55rem;
        font-family: inherit;
        font-size: 0.9rem;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
      }

      .entries-table input[type='text']:focus {
        outline: none;
        border-color: #2563eb;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.18);
      }

      .actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
      }

      button {
        border: none;
        border-radius: 999px;
        padding: 0.65rem 1.4rem;
        font-weight: 600;
        letter-spacing: 0.05em;
        text-transform: uppercase;
        cursor: pointer;
        font-size: 0.78rem;
        transition: transform 0.15s ease, box-shadow 0.2s ease;
        background: #111827;
        color: #ffffff;
      }

      button.secondary {
        background: #e5e7eb;
        color: #111827;
      }

      button.primary {
        background: #2563eb;
      }

      button:hover {
        transform: translateY(-1px);
        box-shadow: 0 15px 25px -15px rgba(15, 23, 42, 0.45);
      }

      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
      }

      .preview-wrapper {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        width: 100%;
      }

      .preview-page {
        position: relative;
        width: var(--page-width);
        min-width: var(--page-width);
        height: var(--page-height);
        background: #ffffff;
        border-radius: 14px;
        padding: var(--page-padding-top) var(--page-padding-right) var(--page-padding-bottom) var(--page-padding-left);
        box-shadow: 0 35px 70px rgba(15, 23, 42, 0.2);
        overflow: hidden;
      }

      .preview-page::after {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: inherit;
        pointer-events: none;
        border: 1px solid rgba(15, 23, 42, 0.08);
      }

      .label-grid {
        position: relative;
        width: 100%;
        height: 100%;
        display: grid;
        grid-template-columns: repeat(2, var(--tag-width));
        grid-auto-rows: var(--tag-height);
        column-gap: var(--column-gap);
        row-gap: var(--row-gap);
        justify-content: center;
        align-content: start;
      }

      .label {
        width: var(--tag-width);
        height: var(--tag-height);
        display: grid;
        grid-template-columns: 3.7cm 1fr;
        background: #ffffff;
        border-radius: 0;
        overflow: hidden;
      }

      .label-card {
        background: var(--tag-bg);
        color: var(--tag-text);
        padding: 0.28cm 0.44cm 0.26cm;
        display: flex;
        flex-direction: column;
        align-items: stretch;
        text-align: center;
        gap: 0.09cm;
        width: 100%;
        height: 100%;
        border-radius: 0;
      }

      .label-card .tag-heading,
      .label-card .price,
      .label-card .unit-line {
        align-self: center;
        text-align: center;
      }

      .label-blank {
        background: #ffffff;
      }

      .tag-heading {
        font-family: var(--heading-font);
        font-size: 0.49cm;
        letter-spacing: 0.05em;
        text-transform: none;
        font-weight: 400;
        line-height: 1.5;
        white-space: nowrap;
        margin: 0;
        transform: scaleY(var(--heading-height-scale));
        transform-origin: center;
      }

      .price {
        font-family: var(--display-font);
        font-size: 1.82cm;
        line-height: 0.7;
        font-weight: 400;
        letter-spacing: 0.01em;
        transform: scaleY(var(--price-height-scale));
        transform-origin: center;
      }

      .unit-line {
        font-size: 0.33cm;
        letter-spacing: 0.06em;
        font-weight: 400;
        color: #ffffff;
        display: flex;
        gap: 0.1cm;
        align-items: baseline;
        justify-content: center;
        font-family: 'Avenir Next', 'Avenir Next LT Pro', 'Avenir', 'Montserrat', sans-serif;
        font-style: italic;
        transform: scaleY(var(--unit-height-scale));
        transform-origin: center;
      }

      .unit-separator {
        text-transform: lowercase;
      }

      .unit-price {
        color: #ffffff;
      }

      .expiry-pill {
        margin-top: auto;
        align-self: center;
        background: #ffffff;
        color: #000000;
        border-radius: 999px;
        padding: 0.12cm 0.36cm;
        font-size: 0.24cm;
        font-weight: 400;
        letter-spacing: 0.06em;
        text-transform: none;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.06cm;
        max-width: 100%;
        white-space: nowrap;
        line-height: 1;
        font-family: 'Avenir Next', 'Avenir Next LT Pro', 'Avenir', 'Montserrat', sans-serif;
        font-style: italic;
        transform: scaleY(var(--expiry-height-scale));
        transform-origin: center;
      }

      .expiry-pill span {
        line-height: 1;
      }

      .expiry-date {
        font-size: 0.2cm;
        letter-spacing: 0.03em;
        color: #000000;
      }

      .price[data-empty='true'],
      .unit-line[data-empty='true'],
      .unit-price[data-empty='true'],
      .unit-text[data-empty='true'],
      .expiry-pill[data-empty='true'],
      .expiry-date[data-empty='true'] {
        opacity: 0.45;
      }

      @page {
        size: A4;
        margin: 0;
      }

      @media print {
        body {
          background: #ffffff;
        }

        header,
        .controls {
          display: none !important;
        }

        main {
          display: block;
          padding: 0;
        }

        .preview-wrapper {
          margin: 0;
          justify-content: flex-start;
        }

        .preview-page {
          box-shadow: none;
          margin: 0;
          width: var(--page-width);
          height: var(--page-height);
        }

        .label-card {
          background: var(--tag-bg) !important;
          color: var(--tag-text) !important;
          -webkit-print-color-adjust: exact;
          print-color-adjust: exact;
        }
      }
    </style>
  </head>
  <body>
    <header>Members Price Tag Generator</header>
    <main>
      <section class="controls" aria-label="Tag controls">
        <div>
          <h2>Tag entries</h2>
          <p class="control-note">
            Enter the price, unit price, unit, and end date for each tag. The layout of every tag matches the provided mock-up.
          </p>
        </div>
        <div class="control-section" aria-label="Font height adjustments">
          <h3>Font height adjustments</h3>
          <p class="control-description">
            Change the vertical stretch of each typographic element without altering its width to fine-tune printed tags.
          </p>
          <div class="scale-controls">
            <div class="scale-row">
              <label for="priceHeight">Price height</label>
              <div class="scale-input">
                <input type="range" id="priceHeight" min="0.6" max="1.5" step="0.01" value="1" />
                <output id="priceHeightValue" class="scale-output" for="priceHeight">1.00×</output>
              </div>
            </div>
            <div class="scale-row">
              <label for="unitHeight">Unit line height</label>
              <div class="scale-input">
                <input type="range" id="unitHeight" min="0.6" max="1.4" step="0.01" value="1" />
                <output id="unitHeightValue" class="scale-output" for="unitHeight">1.00×</output>
              </div>
            </div>
            <div class="scale-row">
              <label for="expiryHeight">Expiry height</label>
              <div class="scale-input">
                <input type="range" id="expiryHeight" min="0.6" max="1.4" step="0.01" value="1" />
                <output id="expiryHeightValue" class="scale-output" for="expiryHeight">1.00×</output>
              </div>
            </div>
          </div>
        </div>
        <div class="entries-table-wrapper">
          <table class="entries-table">
            <thead>
              <tr>
                <th>#</th>
                <th>Price</th>
                <th>Unit price</th>
                <th>Unit</th>
                <th>End date</th>
              </tr>
            </thead>
            <tbody id="entriesBody"></tbody>
          </table>
        </div>
        <div class="actions">
          <button type="button" class="secondary" id="copyFirst">Copy first row to all</button>
          <button type="button" class="secondary" id="clearAll">Clear entries</button>
          <button type="button" class="secondary" id="printSheet">Open print preview</button>
          <button type="button" class="primary" id="downloadPdf">Download PDF</button>
        </div>
      </section>
      <section class="preview-wrapper" aria-label="Tag preview">
        <div class="preview-page" id="tagSheet">
          <div class="label-grid" id="labelGrid"></div>
        </div>
      </section>
    </main>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
      integrity="sha512-YcsIPyk2SGLu1qQEbfXDnpa9eKJeNEqXWiwxupCSvJzpuG1HsfrNcrediOYM/qfNwCuWHa3gwPrmT2yEaE+Fw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    ></script>
    <script>
      (function () {
        const COLUMN_COUNT = 2;
        const ROW_COUNT = 7;
        const TAG_COUNT = COLUMN_COUNT * ROW_COUNT;
        const placeholders = {
          price: '£0.00',
          unitPrice: '£0.00',
          unit: '100g',
          endDate: 'DD/MM/YYYY',
        };

        const tagData = Array.from({ length: TAG_COUNT }, () => ({
          price: '',
          unitPrice: '',
          unit: '',
          endDate: '',
        }));

        const labelGrid = document.getElementById('labelGrid');
        const labelRefs = [];

        const rootElement = document.documentElement;
        const heightControls = [
          { id: 'priceHeight', variable: '--price-height-scale', output: 'priceHeightValue' },
          { id: 'unitHeight', variable: '--unit-height-scale', output: 'unitHeightValue' },
          { id: 'expiryHeight', variable: '--expiry-height-scale', output: 'expiryHeightValue' },
        ];

        const clamp = (value, min, max) => Math.min(Math.max(value, min), max);

        heightControls.forEach(({ id, variable, output }) => {
          const input = document.getElementById(id);
          const outputEl = document.getElementById(output);
          if (!input || !outputEl) return;

          const min = Number.parseFloat(input.min) || 0.5;
          const max = Number.parseFloat(input.max) || 1.5;

          const applyValue = (raw) => {
            const numeric = clamp(Number.parseFloat(raw) || 1, min, max);
            const formatted = numeric.toFixed(2);
            rootElement.style.setProperty(variable, formatted);
            outputEl.textContent = `${formatted}×`;
          };

          applyValue(input.value);

          input.addEventListener('input', (event) => {
            applyValue(event.currentTarget.value);
          });
        });

        function createLabel(index) {
          const label = document.createElement('div');
          label.className = 'label';
          label.innerHTML = `
            <div class="label-card">
              <div class="tag-heading">Members Price</div>
              <div class="price" data-role="price">${placeholders.price}</div>
              <div class="unit-line" data-role="unit-line">
                <span class="unit-price" data-role="unit-price">${placeholders.unitPrice}</span>
                <span class="unit-separator">per</span>
                <span class="unit-text" data-role="unit">${placeholders.unit}</span>
              </div>
              <div class="expiry-pill" data-role="expiry">
                <span class="expiry-label">Expires</span>
                <span class="expiry-date" data-role="end-date">${placeholders.endDate}</span>
              </div>
            </div>
            <div class="label-blank" aria-hidden="true"></div>
          `;
          const priceEl = label.querySelector('[data-role="price"]');
          const unitPriceEl = label.querySelector('[data-role="unit-price"]');
          const unitEl = label.querySelector('[data-role="unit"]');
          const unitLineEl = label.querySelector('[data-role="unit-line"]');
          const expiryEl = label.querySelector('[data-role="end-date"]');
          const expiryPill = label.querySelector('[data-role="expiry"]');
          labelGrid.appendChild(label);
          labelRefs[index] = { priceEl, unitPriceEl, unitEl, unitLineEl, expiryEl, expiryPill };
        }

        for (let i = 0; i < TAG_COUNT; i += 1) {
          createLabel(i);
        }

        function formatDate(value) {
          if (!value) return '';
          const trimmed = value.trim();
          if (/^\d{4}-\d{2}-\d{2}$/.test(trimmed)) {
            const [year, month, day] = trimmed.split('-');
            return `${day}/${month}/${year}`;
          }
          return trimmed;
        }

        function setText(element, value, placeholder) {
          const text = (value || '').trim();
          if (text) {
            element.textContent = text;
            element.dataset.empty = 'false';
          } else {
            element.textContent = placeholder;
            element.dataset.empty = 'true';
          }
        }

        function updateLabel(index) {
          const data = tagData[index];
          const refs = labelRefs[index];
          setText(refs.priceEl, data.price, placeholders.price);
          setText(refs.unitPriceEl, data.unitPrice, placeholders.unitPrice);
          setText(refs.unitEl, data.unit, placeholders.unit);
          const formattedDate = formatDate(data.endDate);
          setText(refs.expiryEl, formattedDate, placeholders.endDate);
          const hasUnitDetails = Boolean((data.unitPrice || '').trim() || (data.unit || '').trim());
          refs.unitLineEl.dataset.empty = hasUnitDetails ? 'false' : 'true';
          refs.expiryPill.dataset.empty = refs.expiryEl.dataset.empty;
        }

        function updateAllLabels() {
          for (let i = 0; i < TAG_COUNT; i += 1) {
            updateLabel(i);
          }
        }

        const entriesBody = document.getElementById('entriesBody');
        const fields = [
          { key: 'price', placeholder: '£4.75' },
          { key: 'unitPrice', placeholder: '£2.38' },
          { key: 'unit', placeholder: '100g' },
          { key: 'endDate', placeholder: '14/08/2025' },
        ];

        tagData.forEach((_, index) => {
          const row = document.createElement('tr');
          const indexCell = document.createElement('td');
          indexCell.textContent = index + 1;
          row.appendChild(indexCell);

          fields.forEach((field) => {
            const cell = document.createElement('td');
            const input = document.createElement('input');
            input.type = 'text';
            input.className = 'entry-input';
            input.dataset.index = index;
            input.dataset.field = field.key;
            input.placeholder = field.placeholder;
            input.autocomplete = 'off';
            input.spellcheck = false;
            cell.appendChild(input);
            row.appendChild(cell);
          });

          entriesBody.appendChild(row);
        });

        const entryInputs = Array.from(document.querySelectorAll('.entry-input'));

        function syncInputsFromData() {
          entryInputs.forEach((input) => {
            const index = Number(input.dataset.index);
            const field = input.dataset.field;
            input.value = tagData[index][field] || '';
          });
        }

        entryInputs.forEach((input) => {
          input.addEventListener('input', (event) => {
            const target = event.currentTarget;
            const index = Number(target.dataset.index);
            const field = target.dataset.field;
            tagData[index][field] = target.value;
            updateLabel(index);
          });
        });

        syncInputsFromData();
        updateAllLabels();

        document.getElementById('copyFirst').addEventListener('click', () => {
          const base = { ...tagData[0] };
          for (let i = 1; i < TAG_COUNT; i += 1) {
            tagData[i] = { ...base };
          }
          syncInputsFromData();
          updateAllLabels();
        });

        document.getElementById('clearAll').addEventListener('click', () => {
          tagData.forEach((item) => {
            item.price = '';
            item.unitPrice = '';
            item.unit = '';
            item.endDate = '';
          });
          syncInputsFromData();
          updateAllLabels();
        });

        const pdfOptions = {
          margin: 0,
          filename: 'members-price-tags.pdf',
          image: { type: 'jpeg', quality: 0.98 },
          html2canvas: { scale: 2, useCORS: true },
          jsPDF: { unit: 'cm', format: 'a4', orientation: 'portrait' },
        };

        document.getElementById('downloadPdf').addEventListener('click', () => {
          const sheet = document.getElementById('tagSheet');
          html2pdf().set(pdfOptions).from(sheet).save();
        });

        document.getElementById('printSheet').addEventListener('click', () => {
          window.print();
        });
      })();
    </script>
  </body>
</html>
